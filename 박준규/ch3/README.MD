# 🧐 3장: 왜 자꾸 String을 쓰지 말라는 거야?

> String 클래스를 잘못 사용하면 애플리케이션에 어떤 영향을 미치는지, 그리고 더 나은 대안은 무엇인지 알아봅니다.

---

## 🔥 1. `String`의 `+=` 연산이 위험한 이유

단순하고 편하다는 이유로 `String`에 `+=` 연산자를 사용해 문자열을 합치는 경우가 많습니다. (특히 DB 쿼리문 작성 시) 하지만 이 방식은 **심각한 성능 저하**를 유발할 수 있습니다.

- **`String` 객체는 불변(Immutable)합니다.**
- `+=` 연산을 실행할 때마다, 기존 문자열을 버리고 **새로운 `String` 객체가 메모리에 생성**됩니다.
- 기존 문자열은 쓸모없는 쓰레기(Garbage)가 되어 GC(Garbage Collection)의 대상이 됩니다.

결과적으로 **메모리 낭비**와 **불필요한 CPU 사용량 증가**로 이어져 시스템 전체의 성능을 저하시킵니다.

---

## ✨ 2. 대안: `StringBuilder` 와 `StringBuffer`

문자열을 동적으로 더해야 할 때는 `StringBuilder` 또는 `StringBuffer`를 사용해야 합니다. 두 클래스는 내부적으로 버퍼(Buffer)를 가지고 있어, 새로운 객체를 계속 만들지 않고 기존 버퍼의 크기를 늘려 문자열을 효율적으로 추가합니다.

| 클래스              | 특징                                         | 언제 사용할까?                                                         |
| ------------------- | -------------------------------------------- | ---------------------------------------------------------------------- |
| **`StringBuilder`** | **스레드에 안전하지 않음 (Not Thread-Safe)** | **단일 스레드** 환경이나 메서드 내에서만 사용할 때 (**대부분의 경우**) |
| **`StringBuffer`**  | **스레드에 안전함 (Thread-Safe)**            | **멀티 스레드** 환경에서 문자열을 공유하고 변경해야 할 때              |

> Tip! append 메서드 안에서 + 연산자를 사용하면 StringBuilder나 StringBuffer를 쓰는 의미가 사라집니다. 연쇄적으로 append를 호출하세요.

```java
// 👎 Bad
sb.append(str1 + str2);`

// 👍 Good
sb.append(str1).append(str2);
```

---

## 💡 3. 추가 성능 팁: `CharSequence` 이해하기

`CharSequence`는 `String`, `StringBuilder`, `StringBuffer` 등이 모두 구현하고 있는 **인터페이스**입니다.

많은 Java 메서드들은 매개변수로 `String` 대신 `CharSequence`를 받도록 설계되어 있습니다. 이는 불필요한 객체 변환을 줄여 메모리 효율을 높이기 위함입니다.

따라서 `StringBuilder`로 만든 값을 굳이 `.toString()`으로 변환하기보다, 가능하다면 **`CharSequence` 타입 그대로 전달**하는 것이 좋습니다.

---

## 🎯 결론: 상황에 맞게 사용하자

| 구분                | 핵심 설명                                                              | 추천 사용처                                                                  |
| ------------------- | ---------------------------------------------------------------------- | ---------------------------------------------------------------------------- |
| **`String`**        | **불변(Immutable)**. 짧고 변하지 않는 문자열을 다룰 때 사용.           | 문자열 리터럴, 메서드의 매개변수 등 변경이 거의 없는 경우.                   |
| **`StringBuilder`** | **가변(Mutable)**. 스레드 안전을 고려할 필요가 없을 때. **성능 우수.** | **단일 스레드 환경**에서의 모든 문자열 조합 및 변경 작업. (ex: 루프 안)      |
| **`StringBuffer`**  | **가변(Mutable)**. **스레드에 안전(Thread-Safe)**.                     | **멀티 스레드 환경**에서 하나의 문자열을 여러 스레드가 동시에 수정하는 경우. |
