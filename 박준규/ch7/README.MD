### 🔍 궁금증 해결: 리플렉션, 왜 알아야 할까요?

**결론부터 말하면, 대부분의 일반적인 개발에서는 리플렉션을 직접 쓸 일이 거의 없습니다.** 하지만 이걸 알아야 하는 이유는 **스프링(Spring) 같은 현대적인 프레임워크가 동작하는 핵심 원리**이기 때문입니다.

프레임워크는 사용자가 어떤 클래스를 만들지 미리 알 수 없습니다. 그럼에도 불구하고 프레임워크는 실행 시점에 클래스를 찾아내 객체를 만들어주고(Dependency Injection), 특정 어노테이션(`@Test`, `@Controller`)이 붙은 메서드를 알아서 실행해 줍니다. 바로 이 **'알아서 찾아내고 실행하는' 마법 같은 일**을 가능하게 하는 기술이 리플렉션입니다.

따라서 리플렉션을 이해하면 **"프레임워크가 내부적으로 어떻게 돌아가는가?"** 에 대한 궁금증을 해결하고, 더 깊이 있는 개발을 할 수 있게 됩니다.

---

---

> 실행 중인 자바 프로그램 내부를 들여다보고 클래스, 메서드, 변수 등의 정보를 알아내거나 동적으로 제어하는 기술인 리플렉션에 대해 알아봅니다.

### **🛠️ 클래스 정보를 얻는 방법: Reflection API**

자바는 `java.lang.reflect` 패키지를 통해 클래스 정보를 다룰 수 있는 API를 제공합니다.

- **`Class` 클래스**: **리플렉션의 시작점.** 클래스에 대한 모든 메타데이터(설명 데이터)를 가지고 있습니다. 일반적으로 `someObject.getClass()` 메서드를 통해 얻습니다.
  - `getName()`: 패키지명을 포함한 전체 클래스 이름을 반환합니다.
  - `getSimpleName()`: 패키지명을 제외한 순수 클래스 이름만 반환합니다.
  - `getFields()`: `public`으로 선언된 변수 정보만 가져옵니다.
  - `getDeclaredFields()`: `private` 등을 포함해 클래스에 선언된 모든 변수 정보를 가져옵니다.
- **`Method`, `Field` 클래스**: 각각 클래스의 메서드와 변수(필드)에 대한 상세 정보를 담고 있으며, `Class` 객체의 `getMethods()`, `getFields()` 등의 메서드를 통해 얻을 수 있습니다.

### **⚠️ 잘못된 사용과 대안**

### **1. 로그 출력 시 `this.getClass().getName()`의 남용**

로그를 남길 때 현재 클래스 이름을 찍기 위해 이 코드를 사용하는 것은 문제가 없지만, **`for`문 같은 반복문 안에서 계속 호출하는 것은 성능 저하의 원인**이 될 수 있습니다. 호출할 때마다 클래스 객체를 찾고, 메서드를 실행하는 약간의 오버헤드가 반복적으로 쌓이기 때문입니다.

### **2. `instanceof` 연산자에 대한 오해**

`instanceof`는 객체가 특정 클래스의 인스턴스인지 확인하는 가장 간단하고 빠른 방법입니다.

- **사용법**: `if (animal instanceof Dog) { ... }`
- **"지양하라"는 말의 진짜 의미**: `instanceof`를 남용하는 것은 객체지향 설계 원칙(LSP)을 위배했을 가능성이 있다는 **'코드 냄새(Code Smell)'** 로 봅니다. 예를 들어, 동물의 종류마다 `if-else if`로 분기하며 다르게 처리하는 코드는 다형성을 제대로 활용하지 못한 것일 수 있습니다. `animal.bark()`처럼 객체가 자신의 행동을 책임지게 하는 것이 더 나은 설계일 수 있다는 의미이지, `instanceof` 자체가 나쁘다는 뜻은 아닙니다.

### **💾 메모리 문제: PermGen과 `OutOfMemoryError`**

- **클래스 정보 저장소**: 클래스 이름, 메서드, 변수 같은 메타데이터는 JVM의 특정 메모리 영역(과거의 PermGen, 현재의 Metaspace)에 저장됩니다.
- **`OutOfMemoryError` 발생 가능성**: 리플렉션을 이용해 **지속적으로 새로운 클래스를 동적으로 만들고 로딩하는 아주 특수한 경우**가 아니라면, 단순히 클래스 정보를 조회하는 것만으로는 이 영역의 메모리 문제를 걱정할 필요는 거의 없습니다.

### **🎯 결론**

- **리플렉션**은 프레임워크의 동작 원리를 이해하는 데 필수적인 강력한 기능입니다.
- 하지만 내부적으로 객체를 생성하고 메서드를 호출하는 등 **오버헤드가 있으므로 성능이 중요한 곳에서는 신중하게 사용**해야 합니다.
- 단순히 클래스 이름을 로그로 남기거나 타입을 확인하는 용도라면, 더 간단하고 빠른 방법을 고려하는 것이 좋습니다.
